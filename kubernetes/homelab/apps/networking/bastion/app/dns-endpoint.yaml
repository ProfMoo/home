---
# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/externaldns.k8s.io/dnsendpoint_v1alpha1.json
apiVersion: externaldns.k8s.io/v1alpha1
kind: DNSEndpoint
metadata:
  name: cloudflared-ssh-drmoo-io
spec:
  # NOTE: This external endpoint doesn't quite work. I am having issues figuring out the precise protocols that
  # cloudflared needs to connect. But the internal VPN-on endpoint should work.
  # Might need to make an external envoy route to get this working in the future.
  endpoints:
    - dnsName: ssh.drmoo.io
      recordType: CNAME
      # NOTE: This GUID is generated by Cloudflare when the tunnel is created.
      # Check the Cloudflare GUI for the tunnel's details.
      targets: ["33b8da1e-d878-4113-be72-c9ad0ac8dc48.cfargotunnel.com"]
---
# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/externaldns.k8s.io/dnsendpoint_v1alpha1.json
apiVersion: externaldns.k8s.io/v1alpha1
kind: DNSEndpoint
metadata:
  name: bastion-internal-drmoo-io
  annotations:
    external-dns.alpha.kubernetes.io/target: "internal.drmoo.io"
spec:
  endpoints:
    - dnsName: bastion.drmoo.io
      recordType: A
      targets: ["192.168.8.140"]
